Data Collection Service
=======================

The Data Collection Service (DCS) is responsible for receiving patient data from a socket and outputting that data via 
GraphQL to the Database Manager (DBM). The DBM makes patient data accessible to other services and is responsible for 
storing aggregated score data and patient background data (patient demographic information) as well.

## Running the Simulator

1. Navigate to the 'data-collection' directory.

2. Build the project.

3. Run the following command (-data param optional, defaults to 'resources'):
    - Static files:
        > `./gradlew runSimulator --args='-data <files path>'`
        
        or with default data dir:
        
        > `./gradlew runSimulator`
    
    - Live files:
        > `./gradlew runSimulator --args='-data <files path> -live'`
    
        or with default data dir:
    
        > `./gradlew runSimulator --args='-live'`

## Running the DCS

1. Navigate to the 'data-collection' directory.

2. Run the following command based on your OS:
    - Linux:
        > `./gradlew run`
    
    - Windows:
        > `gradlew.bat run`

## DBM Setup

1. Install MySQL Server 8.+ or MySQL Server 5.7.+
    - The root password should match the password in ConnectionManager.
2. Create signals database:
    > `mysql -uroot -e "CREATE DATABASE signals"`
3. Run baseline database migration:
    > `mysql -uroot signals < database-manager/src/main/resources/db/migration/V1__Create_all_tables.sql`

## Running the DBM

Navigate to the 'database-manager' directory.

Linux:
> `./gradlew appRun`

Windows:
> `gradlew.bat appRun`

## Interfacing with external data sources

### MediCollector

1. Setup MediCollector BEDSIDE using its setup wizard with sending-data-to-socket enabled at port 2057 (default).

2. Run the DCS on the same machine as the MediCollector application.

### VitalSignsCapture

1. Setup the 'live_vitals.xml' file to use the appropriate files names according to those generated by the 
VitalSignsCapture application. Run VitalSignsCapture first with sensors connected to discover the file names.

2. Run the DCS on the same machine as the VitalSignsCapture application.

3. Run the Simulator with the `-live` option and specify the `-data <files path>` option to be the directory that the
VitalSignsCapture app runs in.